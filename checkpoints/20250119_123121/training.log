PyTorch 版本: 1.13.1+cu117
Using device: cuda
Grouping data by WORD...
[Info] 使用 Tiny Conformer 模型
ConformerEncoder(
  (conv_subsample): Conv2dSubampling(
    (sequential): Sequential(
      (0): Conv2d(1, 512, kernel_size=(3, 3), stride=(2, 2))
      (1): ReLU()
      (2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2))
      (3): ReLU()
    )
  )
  (input_projection): Sequential(
    (0): Linear(
      (linear): Linear(in_features=4608, out_features=512, bias=True)
    )
    (1): Dropout(p=0.1, inplace=False)
  )
  (layers): ModuleList(
    (0): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
)
[Info] 初始模型權重已保存至 ./checkpoints/tiny_40_512_4_2.pt
[Info] use_alpha_beta: True, alpha: 15.0, beta: -3.0

Epoch 1/10
Selected words: ['golfer', 'studied', 'ostensibly', 'expectations', 'transplanted', 'chemically', 'greenish', 'bass']
Step 0, Loss: 1.6382, AUC: 0.2044
Selected words: ['skater', 'shire', 'scouting', 'wolverhampton', 'hulls', 'feral', 'javascript', 'imitated']
Selected words: ['obey', 'depicting', 'agrees', 'aliens', 'oiled', 'flaring', 'fascinated', 'necklaces']
Selected words: ['supervised', 'lyrically', 'ball', 'judgements', 'compass', 'jaws', 'rave', 'survived']
Selected words: ['bavaria', 'boom', 'finger', 'contracting', 'sheridan', 'rejects', 'negotiated', 'little']
Selected words: ['acceptable', 'trust', 'inaccurate', 'vouch', 'ace', 'copy', 'sprouted', 'mir']
Selected words: ['perspective', 'tempt', 'instant', 'antrim', 'landlocked', 'prefecture', 'hoop', 'contest']
Selected words: ['hangar', 'fists', 'bikers', 'worlds', 'shrine', 'gentlemen', 'sizes', 'dan']
Selected words: ['psi', 'venom', 'immediate', 'conquer', 'territorial', 'alexandra', 'swahili', 'harder']
Selected words: ['gipsy', 'honor', 'pocketed', 'continuous', 'tomography', 'committed', 'solution', 'described']
Selected words: ['majority', 'aperture', 'henderson', 'connect', 'rangers', 'clutched', 'recitals', 'typefaces']
Step 10, Loss: 1.9458, AUC: 0.4832
Selected words: ['narratives', 'loudness', 'shriveled', 'due', 'gables', 'lough', 'temperate', 'ridge']
Selected words: ['permitted', 'detachments', 'bentley', 'brunei', 'knight', 'ashanti', 'vague', 'elegant']
Selected words: ['clothed', 'polarized', 'further', 'activity', 'vows', 'rahman', 'comets', 'injuring']
Selected words: ['transported', 'mortality', 'barber', 'defended', 'pakistan', 'importantly', 'stepdad', 'dictating']
Selected words: ['leopold', 'forewarned', 'alternately', 'reilly', 'estate', 'medial', 'walled', 'sophie']
Selected words: ['anterior', 'aware', 'despite', 'dynamical', 'tyrone', 'buoy', 'gold', 'training']
Selected words: ['accompanied', 'haiti', 'indecipherable', 'fixable', 'illustration', 'sheltered', 'bad', 'daughter']
Selected words: ['corrosion', 'dave', 'multiplayer', 'grub', 'api', 'alt', 'wondered', 'oxide']
Selected words: ['uncontrollably', 'icing', 'expo', 'selfie', 'calmed', 'consolation', 'lined', 'pens']
Selected words: ['speckled', 'frost', 'demon', 'vanessa', 'dormitory', 'spoil', 'enquired', 'whirled']
Step 20, Loss: 1.9458, AUC: 0.4872
Selected words: ['exert', 'pavilions', 'promotional', 'withdrew', 'kicks', 'lopez', 'banner', 'gosh']
Selected words: ['ballerina', 'bordered', 'finn', 'spotting', 'lucy', 'marshall', 'englishman', 'he’ll']
Selected words: ['prefers', 'twitter', 'adversity', 'intrigue', 'wicket', 'nerds', 'gel', 'angel']
Selected words: ['trucks', 'peacefully', 'packet', 'testimony', 'exhaustive', 'accompanied', 'rabbits', 'mortality']
Selected words: ['reuse', 'berlin', 'francisco', 'nearsighted', 'bucharest', 'against', 'suitably', 'learner']
Selected words: ['chess', 'manned', 'developed', 'constrained', 'recognition', 'marshmallows', 'portion', 'sundays']
Selected words: ['slap', 'ignorant', 'function', 'sophisticated', 'adaptation', 'symmetric', 'outrageous', 'approaching']
Selected words: ['passaic', 'lizzie', 'superseded', 'ability', 'frustums', 'virtue', 'browsing', 'douglass']
Selected words: ['maintenance', 'currency', 'foreign', 'plutonium', 'advise', 'carson', 'comets', 'rockets']
Selected words: ['picard', 'dunes', 'frocks', 'weeping', 'comedian', 'folklore', 'spiral', 'greater']
Step 30, Loss: 1.9461, AUC: 0.5242
Selected words: ['bridgeport', 'salami', 'counters', 'cosmopolitan', 'telly', 'andalusia', 'lausanne', 'retire']
Selected words: ['klein', 'breeder', 'blogger', 'efficient', 'upside', 'configurations', 'aerodrome', 'larva']
Selected words: ['coordinates', 'nightclub', 'comedies', 'industries', 'repetition', 'mongolian', 'nepal', 'wifi']
Selected words: ['infancy', 'gained', 'hakka', 'tossing', 'screams', 'breaks', 'grilled', 'development']
Selected words: ['movements', 'married', 'abby', 'evolved', 'mora', 'boarded', 'warmly', 'romano']
Selected words: ['nat', 'egypt', 'remote', 'usage', 'importantly', 'cannabis', 'refit', 'greetings']
Selected words: ['blends', 'humanities', 'invaded', 'flogging', 'jim', 'recent', 'casual', 'agony']
Selected words: ['algorithm', 'fibrous', 'compartment', 'toast', 'pail', 'exeter', 'cooling', 'dresden']
Selected words: ['nuclear', 'cellphone', 'dealer', 'incredibly', 'compassion', 'expand', 'belmont', 'disrupted']
Selected words: ['upperparts', 'abraham', 'dangers', 'tasted', 'plutonium', 'tails', 'housekeeper', 'regained']
Step 40, Loss: 1.9456, AUC: 0.4625
Selected words: ['drafty', 'stockport', 'supervisor', 'grille', 'enfield', 'eliminate', 'montenegro', 'aforementioned']
Selected words: ['twists', 'unsuitable', 'stimulate', 'successive', 'hookahs', 'stopping', 'implied', 'woods']
Selected words: ['seldom', 'explosive', 'fitted', 'creating', 'flue', 'north', 'adoption', 'accepts']
Selected words: ['krishna', 'cyrus', 'zora', 'lea', 'wrangle', 'controversies', 'acre', 'titles']
Selected words: ['turnover', 'warfare', 'marxist', 'bookmarks', 'mayonnaise', 'crushing', 'helene', 'piers']
Selected words: ['premiere', 'max', 'avid', 'fetched', 'hash', 'evacuated', 'commanders', 'magazines']
Selected words: ['loafers', 'enrolled', 'inland', 'consisting', 'exhibit', 'formulate', 'yale', 'wisp']
Selected words: ['electricity', 'roller', 'beautifully', 'milestone', 'rocks', 'enable', 'noticeboard', 'stepdad']
Selected words: ['unionist', 'cursed', 'glider', 'circulating', 'rage', 'ufo', 'mysteries', 'feel']
Selected words: ['halo', 'courtesy', 'sally', 'held', 'elaine', 'phrase', 'heavier', 'canonical']
Step 50, Loss: 1.9462, AUC: 0.5310
Selected words: ['fathers', 'stepmother', 'harms', 'strip', 'invariably', 'marie', 'francisco', 'municipalities']
Selected words: ['reflect', 'torus', 'suitcases', 'declaring', 'seas', 'forming', 'burden', 'cobra']
Selected words: ['hate', 'pizzeria', 'motocross', 'statewide', 'looks', 'populated', 'cuts', 'bulky']
Selected words: ['engineer', 'brigadier', 'bridges', 'bonus', 'advocated', 'stuttgart', 'apparatus', 'despicable']
Selected words: ['relying', 'contradictory', 'allah', 'slopes', 'hawthorne', 'liberia', 'ninety', 'compact']
Selected words: ['knocked', 'marquis', 'worrying', 'edit', 'allies', 'rocking', 'odor', 'propelled']
Selected words: ['lodging', 'kaplan', 'lineages', 'insulin', 'expects', 'pint', 'lagos', 'memphis']
Selected words: ['priceless', 'commuter', 'ethnic', 'seasonally', 'philosophical', 'rotates', 'aforementioned', 'duly']
Selected words: ['exists', 'scrap', 'wiltshire', 'rice', 'obsessed', 'retired', 'traumatized', 'join']
Selected words: ['aspiring', 'factor', 'herd', 'physicists', 'tasked', 'hearts', 'caddies', 'skateboard']
Step 60, Loss: 1.9461, AUC: 0.5112
Selected words: ['chests', 'detach', 'aragon', 'colombo', 'illustrator', 'radiogram', 'procrastination', 'harley']
Selected words: ['rudd', 'coin', 'enforce', 'tool', 'mod', 'commodities', 'spinning', 'droned']
Selected words: ['routines', 'hunts', 'pardoned', 'cows', 'mohawk', 'undergone', 'comedic', 'started']
Selected words: ['broad', 'bmx', 'hebron', 'scorpions', 'operation', 'tonga', 'advisor', 'terrace']
Selected words: ['convenient', 'alleged', 'perry', 'priesthood', 'anyone', 'income', 'frosty', 'spikes']
Selected words: ['output', 'pianoforte', 'summa', 'professor', 'leyte', 'lyle', 'plywood', 'composers']
Selected words: ['nasa', 'moses', 'loafers', 'washing', 'newton', 'promotions', 'funding', 'pillar']
Selected words: ['apiarist', 'buys', 'canyons', 'customs', 'received', 'heated', 'witch', 'torches']
Selected words: ['suspect', 'informs', 'version', 'consist', 'lithuanian', 'posted', 'headmaster', 'mock']
Selected words: ['cantor', 'marion', 'retort', 'flashing', 'rowing', 'dries', 'identities', 'mitch']
Step 70, Loss: 1.9459, AUC: 0.5201
Selected words: ['embracing', 'tortured', 'issue', 'drummond', 'volume', 'kenny', 'balance', 'corpus']
Selected words: ['republics', 'casinos', 'paws', 'hodges', 'suffused', 'frenzy', 'severed', 'recording']