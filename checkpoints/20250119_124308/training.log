PyTorch 版本: 1.13.1+cu117
Using device: cuda
Grouping data by WORD...
[Info] 使用 Tiny Conformer 模型
ConformerEncoder(
  (conv_subsample): Conv2dSubampling(
    (sequential): Sequential(
      (0): Conv2d(1, 512, kernel_size=(3, 3), stride=(2, 2))
      (1): ReLU()
      (2): Conv2d(512, 512, kernel_size=(3, 3), stride=(2, 2))
      (3): ReLU()
    )
  )
  (input_projection): Sequential(
    (0): Linear(
      (linear): Linear(in_features=4608, out_features=512, bias=True)
    )
    (1): Dropout(p=0.1, inplace=False)
  )
  (layers): ModuleList(
    (0): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (1): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (2): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (3): ConformerBlock(
      (sequential): Sequential(
        (0): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (1): ResidualConnectionModule(
          (module): MultiHeadedSelfAttentionModule(
            (positional_encoding): PositionalEncoding()
            (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (attention): RelativeMultiHeadAttention(
              (query_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (key_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (value_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
              (pos_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=False)
              )
              (dropout): Dropout(p=0.1, inplace=False)
              (out_proj): Linear(
                (linear): Linear(in_features=512, out_features=512, bias=True)
              )
            )
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): ResidualConnectionModule(
          (module): ConformerConvModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Transpose()
              (2): PointwiseConv1d(
                (conv): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
              )
              (3): GLU()
              (4): DepthwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(31,), stride=(1,), padding=(15,), groups=512, bias=False)
              )
              (5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
              (6): Swish()
              (7): PointwiseConv1d(
                (conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
              )
              (8): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (3): ResidualConnectionModule(
          (module): FeedForwardModule(
            (sequential): Sequential(
              (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (1): Linear(
                (linear): Linear(in_features=512, out_features=2048, bias=True)
              )
              (2): Swish()
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(
                (linear): Linear(in_features=2048, out_features=512, bias=True)
              )
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (4): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
)
[Info] 初始模型權重已從 ./checkpoints/tiny_40_512_4_2.pt 加載。
[Info] use_alpha_beta: True, alpha: 10.0, beta: -5.0

Epoch 1/10
Selected words: ['dumps', 'varied', 'term', 'cheney', 'circles', 'drafting', 'avoiding', 'rooster']
Step 0, Loss: 1.8817, AUC: 0.3515
Selected words: ['trudeau', 'clustering', 'ambassador', 'sprained', 'headaches', 'tennis', 'harrow', 'savagery']
Selected words: ['defendant', 'suggested', 'converse', 'somehow', 'covington', 'sworn', 'dirt', 'unpleasant']
Selected words: ['microphone', 'straps', 'basalt', 'weinberg', 'ratings', 'grin', 'vortex', 'gaining']
Selected words: ['holder', 'nitrogen', 'demolished', 'hindu', 'evident', 'regret', 'kidnapping', 'offenders']
Selected words: ['tipton', 'suggest', 'rent', 'wicklow', 'eigtheen', 'squished', 'mysticism', 'respond']
Selected words: ['thunderstorms', 'integrals', 'record', 'oath', 'hence', 'printing', 'zeus', 'rating']
Selected words: ['duration', 'buddhism', 'rabbi', 'enthusiasm', 'cameroon', 'westward', 'narrator', 'mennonite']
Selected words: ['auburn', 'parted', 'crook', 'err', 'requests', 'married', 'belmont', 'prepares']
Selected words: ['slain', 'affection', 'loyalty', 'grape', 'school’s', 'catches', 'dicaprio', 'heritage']
Selected words: ['healy', 'drained', 'competition', 'blossoms', 'reggae', 'comedy', 'sterling', 'commencement']
Step 10, Loss: 1.9455, AUC: 0.4718
Selected words: ['cleavage', 'wept', 'gunner', 'harbor', 'references', 'livid', 'stampeded', 'evolving']
Selected words: ['dietary', 'barrio', 'vat', 'thistles', 'dom', 'overthink', 'faintly', 'tactics']
Selected words: ['oriented', 'learning', 'invertebrates', 'chung', 'nephews', 'seneca', 'guard', 'jesus']
Selected words: ['glinda', 'blanc', 'organize', 'pietro', 'pesticides', 'strength', 'cork', 'ahmed']
Selected words: ['sorted', 'aspect', 'utopian', 'sellers', 'practices', 'harvard', 'peculiar', 'withdrawal']
Selected words: ['stitch', 'plastic', 'vouch', 'mitch', 'theatre', 'cubic', 'teutonic', 'maid']
Selected words: ['federalist', 'contexts', 'villains', 'joseph', 'dissolve', 'fiscal', 'implements', 'desist']
Selected words: ['abandoned', 'curses', 'bulldog', 'wisest', 'reducing', 'acknowledge', 'tudor', 'public']
Selected words: ['blackness', 'complementary', 'attended', 'always', 'sponsorship', 'discs', 'seasoned', 'activism']
Selected words: ['paperback', 'owen', 'lifeguards', 'investigated', 'amanda', 'blared', 'impolite', 'potassium']
Step 20, Loss: 1.9494, AUC: 0.4347
Selected words: ['resolved', 'wilkinson', 'netherlands', 'embrace', 'ionia', 'delight', 'melody', 'uganda']
Selected words: ['petals', 'suits', 'mayday', 'immortal', 'traffic', 'sanford', 'presented', 'dawson']
Selected words: ['gravel', 'migration', 'swings', 'promotes', 'engaged', 'hue', 'rules', 'downloaded']
Selected words: ['fayoum', 'posed', 'poets', 'joy', 'wellman', 'flattery', 'escapes', 'rebranded']
Selected words: ['confederation', 'tractors', 'belle', 'clause', 'remodeled', 'oracle', 'prisoners', 'casual']
Selected words: ['bergen', 'sixteen', 'confederate', 'newfoundland', 'lessons', 'displayed', 'burned', 'rains']
Selected words: ['handle', 'usb', 'prudence', 'seats', 'towels', 'peptide', 'monsoon', 'wrestle']
Selected words: ['outward', 'joshua', 'alloy', 'sunburn', 'shariah', 'sealed', 'dismantled', 'consul']
Selected words: ['owns', 'ignition', 'dundee', 'collectors', 'brewing', 'toasted', 'cheer', 'galactic']
Selected words: ['simplifying', 'functioning', 'dotted', 'nirvana', 'iceland', 'directed', 'riemann', 'entered']
Step 30, Loss: 1.9456, AUC: 0.4638
Selected words: ['apostles', 'warmly', 'terraces', 'painting', 'associations', 'husk', 'neighbourhoods', 'terrified']
Selected words: ['shortsighted', 'incarnation', 'saga', 'disappearance', 'ornament', 'symbolize', 'playable', 'swooping']
Selected words: ['mystical', 'clones', 'sophomore', 'i’ll', 'custody', 'greeting', 'mets', 'bhutan']
Selected words: ['cobs', 'medici', 'monterrey', 'minors', 'trigger', 'hutchinson', 'standing', 'deception']
Selected words: ['distracted', 'narratives', 'stiff', 'credentials', 'rage', 'rica', 'lemme', 'cloth']
Selected words: ['martinez', 'basins', 'savings', 'beatty', 'showcase', 'candle', 'aesthetically', 'bathurst']
Selected words: ['ironically', 'shaded', 'iceland', 'bland', 'exceeded', 'calhoun', 'painter', 'beetles']
Selected words: ['con', 'savanna', 'zones', 'salted', 'han', 'receiving', 'unorthodox', 'sanchez']
Selected words: ['depicted', 'claus', 'dudley', 'consortium', 'damages', 'mccartney', 'moses', 'whiff']
Selected words: ['macros', 'seminar', 'also', 'brewed', 'organisms', 'travel', 'monte', 'rematch']
Step 40, Loss: 1.9459, AUC: 0.5000
Selected words: ['taser', 'selections', 'allowing', 'latencies', 'compatible', 'susan', 'evergreen', 'abelian']
Selected words: ['shudder', 'conserved', 'jacques', 'littles', 'analogous', 'depart', 'wildcats', 'herman']
Selected words: ['evacuated', 'baseline', 'asthma', 'taboo', 'pistols', 'wakefield', 'horizontal', 'protest']
Selected words: ['fined', 'zora', 'digest', 'loyal', 'diagrams', 'explores', 'contradict', 'twin']
Selected words: ['tube', 'confess', 'aqueous', 'weakly', 'nukes', 'tiffany', 'occured', 'seton']
Selected words: ['dumbarton', 'regard', 'extent', 'clone', 'expose', 'limiting', 'walled', 'seminars']
Selected words: ['seaman', 'walker', 'proportions', 'volcano', 'liu', 'selections', 'clovers', 'adverse']
Selected words: ['glasses', 'vitality', 'ruth', 'closely', 'herb', 'augustus', 'newman', 'doubt']
Selected words: ['catalan', 'yugoslav', 'kendall', 'enthusiast', 'builder', 'het', 'parkes', 'deadlocked']
Selected words: ['consisting', 'bulgaria', 'lyons', 'skirt', 'neutralize', 'visibility', 'aloof', 'american']
Step 50, Loss: 1.9457, AUC: 0.4877
Selected words: ['mysteriously', 'anaconda', 'repercussions', 'sticking', 'burgeoning', 'any', 'ask', 'authorized']
Selected words: ['fielding', 'wrists', 'hispanic', 'immense', 'sigh', 'rushing', 'westernmost', 'sheppard']
Selected words: ['vain', 'biker', 'links', 'considered', 'afterlife', 'hash', 'halifax', 'theologian']
Selected words: ['icing', 'repeat', 'showers', 'wage', 'immensely', 'personally', 'alex', 'murder']
Selected words: ['induce', 'slogans', 'wyatt', 'finally', 'tracked', 'motors', 'assessment', 'solemn']
Selected words: ['beaches', 'passed', 'blinded', 'conservation', 'explored', 'shooter', 'whales', 'haines']
Selected words: ['arabic', 'salzburg', 'rig', 'motorcycles', 'labyrinth', 'golfing', 'invertebrates', 'minimal']
Selected words: ['outgoing', 'speculation', 'floppy', 'locations', 'bribe', 'expenditures', 'designate', 'swings']
Selected words: ['miller', 'dame', 'outrageous', 'marino', 'bashing', 'melted', 'regret', 'incorporates']
Selected words: ['atoms', 'attack', 'childbirths', 'floppy', 'eels', 'signals', 'locusts', 'unlike']
Step 60, Loss: 1.9457, AUC: 0.4765
Selected words: ['haven', 'addition', 'oblique', 'fairs', 'backstage', 'jammed', 'migratory', 'sylvia']
Selected words: ['recognizable', 'tension', 'swat', 'lin', 'framed', 'outside', 'pleaded', 'replied']
Selected words: ['stiffer', 'resurrection', 'beverly', 'hopkins', 'staten', 'joel', 'muffled', 'larger']
Selected words: ['provincial', 'resorts', 'writer', 'mystical', 'vladimir', 'geyser', 'flavours', 'weighed']
Selected words: ['penalties', 'crusty', 'around', 'hybrids', 'trailer', 'constituent', 'philippe', 'goddard']
Selected words: ['codec', 'editions', 'uncontrollable', 'imperative', 'professions', 'bonus', 'sorts', 'hours']
Selected words: ['crash', 'granite', 'europeans', 'rifles', 'provides', 'queen', 'otto', 'coalition']
Selected words: ['tremulous', 'adverbs', 'wife', 'glacier', 'himalayas', 'jurisdictions', 'loves', 'myths']
Selected words: ['civic', 'socially', 'dominate', 'crews', 'wyoming', 'boutique', 'happens', 'watch']
Selected words: ['ripley', 'sociology', 'wedding', 'supplier', 'baird', 'salzburg', 'decide', 'pub']
Step 70, Loss: 1.9456, AUC: 0.4655
Selected words: ['arranges', 'resulting', 'luna', 'lambda', 'primes', 'maureen', 'seventeen', 'crewe']
Selected words: ['upland', 'pawn', 'certificate', 'scratch', 'bids', 'jedi', 'rosemary', 'campaigning']
Selected words: ['principal', 'temperance', 'bryant', 'malcolm', 'apollo', 'hit', 'diana', 'calculation']